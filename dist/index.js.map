{"version":3,"sources":["index.es6"],"names":[],"mappings":"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","file":"index.js","sourcesContent":["/**\n * @ngdoc overview\n * @name de.ds82.juice\n */\n\n//\n// Array.prototype.find polyfill\n// https://developer.mozilla.org/de/docs/Web/JavaScript/Reference/Global_Objects/Array/find\n//\nif (!Array.prototype.find) {\n  Array.prototype.find = function(predicate) {\n    if (!this) {\n      throw new TypeError('Array.prototype.find called on null or undefined');\n    }\n    if (typeof predicate !== 'function') {\n      throw new TypeError('predicate must be a function');\n    }\n    var list = Object(this);\n    var length = list.length >>> 0;\n    var thisArg = arguments[1];\n    var value;\n\n    for (var i = 0; i < length; i++) {\n      value = list[i];\n      if (predicate.call(thisArg, value, i, list)) {\n        return value;\n      }\n    }\n    return undefined;\n  };\n}\n\nclass TinyDi {\n  constructor() {\n\n    this.resolving = [];\n\n    this.bindings = {};\n    this.nsBindings = [];\n\n    this.resolverFn = this.getDefaultResolver();\n  }\n\n  getDefaultResolver() {\n    return function(file) {\n      return require(file);\n    };\n  }\n\n  resolveKey(key) {\n    if (this.hasBinding(key)) {\n      return key;\n    }\n\n    var moduleDelimiter = String(key).lastIndexOf('/');\n    var prefix = key.substring(0, moduleDelimiter);\n    var suffix = key.substring(moduleDelimiter);\n\n    if (prefix && prefix.length) {\n\n      var ns = this.nsBindings.find(function(element) {\n        return element.ns.match(prefix);\n      });\n\n      if (ns) {\n        return ns.path + suffix;\n      }\n    }\n\n    return key;\n  }\n\n  hasBinding(key) {\n    return !!this.bindings[key];\n  }\n\n  setResolver(resolverFn) {\n    this.resolverFn = resolverFn;\n  }\n\n  bind(key) {\n    return new Binding(this, key);\n  }\n\n  ns(space) {\n    return new PathBinding(this, space);\n  }\n\n  setNsBinding(ns, dir) {\n    this.nsBindings.push({ ns: ns, path: dir });\n  }\n\n  set(key, object) {\n    this.bindings[key] = object;\n    return object;\n  }\n\n  load(key, what) {\n    what = this.resolveKey(what);\n    var resolved = this.resolverFn(what);\n\n    if (resolved) {\n      this.markResolving(key);\n      var object = this.apply(resolved);\n      this.set(key, object);\n      this.markResolved(key);\n      return object;\n    }\n  }\n\n  lazy(key) {\n    if (this.isCircularDep(key)) {\n      // console.log('tried to resolve:', this.resolving);\n      throw new Error('Circular dependency found; abort loading');\n    }\n    return this.load(key, key);\n  }\n\n  getBinding(key) {\n    var binding = this.bindings[key];\n    if (binding instanceof Lazy) {\n      return binding.load();\n    }\n    return binding;\n  }\n\n  get(key) {\n    return (this.bindings[key]) ?\n      this.getBinding(key) :\n      this.lazy(key);\n  }\n\n  apply(fn, that) {\n\n    if (fn && fn.$inject && typeof fn === 'function') {\n      var argumentList = fn.$inject.map(this.get, this);\n      return fn.apply(that, argumentList);\n    }\n    return fn;\n  }\n\n  markResolving(key) {\n    this.resolving.push(key);\n  }\n\n  markResolved(key) {\n    var index = this.resolving.indexOf(key);\n    if (index > -1) {\n      this.resolving.splice(index, 1);\n    }\n  }\n\n  isCircularDep(key) {\n    // console.log('isCircularDep', key, this.resolving.indexOf(key));\n    return (this.resolving.indexOf(key) > -1);\n  }\n}\n\nclass Lazy {\n  constructor(injector, key, path) {\n    this.injector = injector;\n    this.key = key;\n    this.path = path;\n  }\n\n  load() {\n    return this.injector.load(this.key, this.path);\n  }\n}\n\nclass Binding {\n  constructor(injector, key) {\n    this.injector = injector;\n    this.key = key;\n  }\n\n  to(object) {\n    this.injector.set(this.key, object);\n    return this.injector;\n  }\n\n  lazy(path) {\n    var lazyBind = new Lazy(this.injector, this.key, path);\n    this.injector.set(this.key, lazyBind);\n  }\n\n  apply(fn) {\n    this.injector.set(this.key, this.injector.apply(fn));\n  }\n\n  load(file) {\n    return this.injector.set(this.key, this.injector.get(file));\n  }\n}\n\nclass PathBinding {\n  constructor(injector, key) {\n    this.injector = injector;\n    this.key = key;\n  }\n\n  to(dir) {\n    this.injector.setNsBinding(this.key, dir);\n  }\n}\n\nmodule.exports = function() {\n  return new TinyDi();\n};\n\n"],"sourceRoot":"/source/"}